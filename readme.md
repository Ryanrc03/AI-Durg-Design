The code of this work is based on Druggen
